### Моменты ДСВ
Начальные:
$$\mu_k = M(r^k) = \sum_{i=1}^n x_i^k \cdot p_i$$
Центральные:
$$\mu_k^0 = M[(r - M[r])^k] = \sum_{i=1}^n (x_i - M[r])^k \cdot p_i$$
Зная все моменты, можем восстановить распределение.
Если $n < \infty$, то достаточно первых ($2n$) начальных моментов.
На практике больше первых 4-x моментов не используют.<br><span class="zero-width">&#8203;</span>
Если $n = \infty$, то моменты связаны с суммами рядов:
$$M\xi = \sum_{i=1}^{\infty} x_i^k \cdot p_i$$
Как бы избежать суммирования рядов и взятия интегралов, сделав всё это искусством?
### Производящая функция моментов
Нужно алгебраизировать задачу ($\sum$ рядов в произв. знач.) — ввести так называемую **производящую функцию моментов** (moments generating function, mgf).<br><span class="zero-width">&#8203;</span>
ДСВ:
$$
r:
\left\{
\begin{array}{l}
  x: \quad x_1 \quad x_2 \quad \ldots \quad x_n \\
  p: \quad~ p_1 \quad p_2 \quad \ldots \quad p_n
\end{array}
\right.
$$
А вот и дискретное преобразование Фурье:
$$g_r(\nu) = M[e^{\nu r}]$$
$$g_r(\nu) = M[e^{\nu r}) = \sum_{i=1}^n e^{\nu x_i} \cdot p_i$$
Также производящая функция моментов обладает рядом полезных свойств.
### Свойства
<span>1)</span>  Нулевая производная от  по аргументу :
$$g_r(0) = \sum_{i=1}^n e^{0} \cdot p_i = \sum_{i=1}^n p_i = 1$$
<span>2)</span> Первая производная от $g_r(\nu)$ по аргументу $\nu$:
$$\frac{d g_r(\nu)}{d\nu} = \frac{d}{d\nu} \sum_{i=1}^n e^{\nu x_i} \cdot p_i = \sum_{i=1}^n \frac{d}{d\nu} (e^{\nu x_i} \cdot p_i) = \sum_{i=1}^n x_i e^{\nu x_i} \cdot p_i$$
$$\frac{d g_r(0)}{d\nu} = \sum_{i=1}^n x_i \cdot e^0 \cdot p_i = \sum_{i=1}^n x_i \cdot p_i = M[r]$$
<span>3.1)</span> Вторая производная от $g_r(\nu)$ по аргументу $\nu$:
$$\frac{d^2 g_r(\nu)}{d\nu^2} = \sum_{i=1}^n x_i^2 \cdot e^{\nu x_i} \cdot p_i$$
$$\frac{d^2 g_r(0)}{d\nu^2} = \sum_{i=1}^n x_i \cdot e^0 \cdot p_i = \sum_{i=1}^n x_i^2 \cdot  p_i = M_2[r]$$
<span>3.2)</span> k-я производная от $g_r(\nu)$ по аргументу $\nu$:
$$\frac{d^k g_r(\nu)}{d\nu^k} = \sum_{i=1}^n x_i^k \cdot e^{\nu x_i} \cdot p_i$$
$$\frac{d^k g_r(0)}{d\nu^k} = \sum_{i=1}^n x_i \cdot e^0 \cdot p_i = \sum_{i=1}^n x_i^k \cdot  p_i = M_k[r]$$
$$Искусство → ремесло~(это~хорошо)$$
<span>4)</span> Если известна $g_r(\nu)$, то можем восстановить распределение.
<span>5)</span> Пусть $\r_1, \r_2, \ldots, \r_n$ — сходящаяся последовательность ДСВ:
$$\lim_{n \to \infty} r_n = r_{\text{lim}}$$
Тогда сходится и последовательность функций:
$$g_{r_1}(\nu),~g_{r_2}(\nu),~\ldots,~g_{r_n}(\nu),~\ldots$$
$$\lim_{n \to \infty} g_{r_n}(\nu) = g_{r_{\text{lim}}}(\nu)$$
или
$$\boxed{g_{\lim}(\nu) = g_{r_{\text{lim}}}(\nu)}$$
---
* при $\nu=0$ — площадь под кривой, ведь в 0 возникает усреднение
---
### Пример: биномиальное распределение
`Схема Бернулли`: 
- $n$ испытаний
- $p$ — вероятность успеха в каждом опыте
- $r$ — количество осуществившихся успехов
$$
r:
\left\{
\begin{array}{l}
  x: \quad x_1 \quad x_2 \quad \ldots \quad x_n \\
  p: \quad~ p_1 \quad p_2 \quad \ldots \quad p_n
\end{array}
\right.
$$
$$P_n(m) = C_n^m \cdot p^m \cdot (1 - p)^{n - m}$$
$$g_r(\nu) = \mu[e^{\nu m}] = \sum_{i=1}^{n+1} e^{\nu x_i} p_i = \sum_{m=0}^n e^{\nu m} p_n(m) =$$
$$= \sum_{m=0}^n e^{\nu  m} C_n^m p^m (1 - p)^{n - m} = \sum_{m=0}^n C_n^m (p e^{\nu})^m (1 - p)^{n - m} \overset{\text{полный бином}}{\underset{\text{Ньютона}}{=}} \boxed{(p e^{\nu} + 1 - p)^n}$$
Найдём $M[r], D[r]$:
$$\frac{d g_r(\nu)}{d\nu} = n (p e^{\nu} + 1 - p)^{n - 1} p e^{\nu}$$
$$\frac{d g_r(0)}{d\nu} = n p e^{0} (p e^{0} + 1 - p)^{n - 1} = n p \Rightarrow \boxed{M[r] = n p}$$
$$\frac{d^2 g_r(\nu)}{d\nu^2} = n (n - 1) (p e^{\nu} + 1 - p)^{n - 2} p e^{\nu} + np e^{\nu}(pe^{\nu} + 1 - p)^{n - 1}$$

$$\frac{d^2 g_r(0)}{d\nu^2} = n (n - 1) p^2 + n p = n^2 p^2 - n p^2 + n p$$
$$D[r] = \mu_2[r] - M^2[r] = n^2p^2 - np^2 + np - n^2p^2 = \boxed{np(1 - p)}$$
$$\Downarrow$$
$$\sigma_r = \sqrt{D[r]} = \sqrt{np(1-p)}$$
---
Сравнение с алгебраическим методом:
$$\sum_{m=0}^{n} mC_n^m p^m (1 - p)^{n - m}$$
$$\sum_{m=0}^{n} (m - np)^2 C_n^m p^m (1 - p)^{n - m} = \boxed{np(1 - p)}?$$
---
Мини-пример:
$$
\begin{array}{c|c c}
p = 0.5 & & np = 100 \cdot 0.5 = 50 \\
& \Rightarrow \\
n = 100 & & \sqrt{np(1 - p)} = \sqrt{100 \cdot 0.5 \cdot 0.5} = 5 \\
\end{array}
$$
С шансами примерно 95% равно:
$$\ 50 \pm 2 \cdot \underbrace{5}_{коэф.стьюд.} \Rightarrow 50 \pm 10$$
### Формула Пуассона
`Формула Бернулли`:
$$P_n(m) = C_n^m p^m (1 - p)^{n - m}$$
Пусть 
$$
\begin{array}{c|c}
n = 1000 & \\
& \Rightarrow P_{1000}(50) = \underbrace{\frac{1000!}{50! \cdot 950!}}_{\infty} \underbrace{(0.001)^{50}}_{0} \underbrace{(0.999)^{950}}_{\text{double в комп.}}\\
p = 0.001 & \\
\end{array}
$$
(Сложно в компьютере — двойная неустойчивость: $\infty = 10^{307};~0 = 10^{-307}$)
$$
\text{Численная неустойчивость} ⇒
\begin{align}
&1. ~\text{Длинная арифметики (ошибки)} \\
&2. ~\text{Асимптотические приближения}
\end{align}
$$
Условный в безусловный:
$$\lim_{n \to \infty} P_n(m) = \lim_{n \to \infty} C_n^m p^m (1 - p)^{n - m} = \lim_{n \to \infty} C_n^m (\frac{\alpha}{n})^m(1 - \frac{\alpha}{n})^{n - m} =$$
при успехе $n p = \lambda = const$
$$= \lim_{n \to \infty} \frac{n!}{m!(n - m)!} \cdot \left(\frac{\alpha}{n}\right)^m \cdot \left(1 - \frac{\alpha}{n}\right)^{n - m} =$$
$$= \frac{\alpha^m}{m!} \cdot \lim_{n \to \infty} \frac{n(n - 1)(n - 2) \cdot \ldots \cdot(n - m)}{n^m} \cdot \left(1 - \frac{\alpha}{n}\right)^{n} \cdot \left(1 - \frac{\alpha}{n}\right)^{-m} =$$
$$= \frac{\alpha^m}{m!} \cdot \lim_{n \to \infty} \underbrace{1}_{1} \cdot \underbrace{(1 - \tfrac{1}{n})}_{1}\underbrace{(1 - \tfrac{2}{n})}_{1}\cdot\ldots\cdot\underbrace{(1 - \tfrac{m - 1}{n})}_{1} \cdot \underbrace{\left(1 - \tfrac{\alpha}{n}\right)^{-m}}_{1} \cdot \underbrace{\left(1 - \tfrac{\alpha}{n}\right)^n}_{e^{-\alpha}} \Rightarrow$$
Так как
$$(1 + \tfrac{1}{n})^n \to e,$$
то
$$\Rightarrow \boxed{\frac{\lambda^m}{m!} \cdot e^{-\alpha}}$$
$$\alpha = np = 1$$
Численных неустойчивостей нет.